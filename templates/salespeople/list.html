{% extends "base.html" %}

{% block title %}Salespeople - Cross CRM{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="hero-section mb-4">
    <div class="hero-content">
        <h1><i class="bi bi-people"></i> Sales Team</h1>
        <p>Manage your sales team and track performance</p>
    </div>
</div>

<!-- Performance Stats -->
<div class="pipeline-stats mb-4">
    <div class="stat-item">
        <div class="stat-label">Total Team Revenue</div>
        <div class="stat-value">${{ "{:,.0f}".format(total_revenue) }}</div>
    </div>
    <div class="stat-item">
        <div class="stat-label">Team Members</div>
        <div class="stat-value">{{ users|length }}</div>
    </div>
    <div class="stat-item">
        <div class="stat-label">Total Deals Won</div>
        <div class="stat-value">{{ total_won }}</div>
    </div>
</div>

<!-- Salespeople Grid -->
<div class="salesperson-grid">
    {% for user in users %}
    <div class="user-card">
        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=300&fit=crop&q=80&sig={{ user.id }}" 
             alt="{{ user.full_name }}" 
             class="user-card-image"
             onerror="this.onerror=null; this.src='https://ui-avatars.com/api/?name={{ user.full_name|urlencode }}&background=e50914&color=fff&size=200'">
        <div class="user-card-body">
            <div class="user-card-name">{{ user.full_name }}</div>
            <div class="user-card-role">{{ user.role.value|title }}</div>
            <div class="mt-3">
                {% if performance.get(user.id) %}
                <div class="mb-2">
                    <small class="text-muted d-block">Total Revenue</small>
                    <strong style="color: #e50914;">${{ "{:,.0f}".format(performance[user.id].total_revenue) }}</strong>
                </div>
                <div class="row g-2 mb-2">
                    <div class="col-6">
                        <small class="text-muted d-block">Won Deals</small>
                        <strong>{{ performance[user.id].won_deals }}</strong>
                    </div>
                    <div class="col-6">
                        <small class="text-muted d-block">Active Deals</small>
                        <strong>{{ performance[user.id].active_deals }}</strong>
                    </div>
                </div>
                <div class="mb-2">
                    <small class="text-muted d-block">Pipeline Value</small>
                    <strong>${{ "{:,.0f}".format(performance[user.id].pipeline_value) }}</strong>
                </div>
                {% else %}
                <p class="text-muted small mb-0">No performance data yet</p>
                {% endif %}
            </div>
            <a href="/salespeople/{{ user.id }}" class="btn btn-primary w-100 mt-3">
                <i class="bi bi-eye"></i> View Profile
            </a>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}

