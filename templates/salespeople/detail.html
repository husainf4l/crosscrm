{% extends "base.html" %}

{% block title %}{{ user.full_name }} - Cross CRM{% endblock %}

{% block content %}
<!-- Hero Section with User Image -->
<div class="hero-section mb-4" style="min-height: 300px;">
    <div class="hero-content">
        <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200&h=200&fit=crop&q=80&sig={{ user.id }}" 
             alt="{{ user.full_name }}" 
             class="rounded-circle mb-3"
             style="width: 120px; height: 120px; object-fit: cover; border: 4px solid #e50914;"
             onerror="this.onerror=null; this.src='https://ui-avatars.com/api/?name={{ user.full_name|urlencode }}&background=e50914&color=fff&size=200'">
        <h1>{{ user.full_name }}</h1>
        <p class="text-muted">{{ user.role.value|title }} â€¢ {{ user.email }}</p>
    </div>
</div>

{% if performance %}
<div class="row mb-4">
    <div class="col-md-3">
        <div class="card metric-card">
            <div class="card-body">
                <h6 class="text-muted">Total Revenue</h6>
                <h4>${{ "{:,.2f}".format(performance.total_revenue) }}</h4>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card metric-card">
            <div class="card-body">
                <h6 class="text-muted">Won Deals</h6>
                <h4>{{ performance.won_deals }}</h4>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card metric-card">
            <div class="card-body">
                <h6 class="text-muted">Active Deals</h6>
                <h4>{{ performance.active_deals }}</h4>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card metric-card">
            <div class="card-body">
                <h6 class="text-muted">Pipeline Value</h6>
                <h4>${{ "{:,.2f}".format(performance.pipeline_value) }}</h4>
            </div>
        </div>
    </div>
</div>
{% endif %}

<div class="card">
    <div class="card-header">
        <h5>Deals</h5>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Value</th>
                        <th>Stage</th>
                        <th>Probability</th>
                        <th>Contact</th>
                    </tr>
                </thead>
                <tbody>
                    {% for deal in deals %}
                    <tr>
                        <td><a href="/deals/{{ deal.id }}">{{ deal.title }}</a></td>
                        <td>${{ "{:,.2f}".format(deal.value) }}</td>
                        <td><span class="badge bg-secondary">{{ deal.stage.value.replace('_', ' ').title() }}</span></td>
                        <td>{{ deal.probability }}%</td>
                        <td>{{ deal.contact.first_name if deal.contact else '-' }} {{ deal.contact.last_name if deal.contact else '' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock %}

